<link rel="import" href="/vendor/polymer/polymer.html">

<dom-module id="cuac-schedule-days">
    <template>
        <div class="form-group">
            <input type="checkbox" class="all-day-checkbox" on-change="checkAllDays" on-click="toggleChecked" data-day="allDays">
                Select all<br>
            <template is="dom-repeat" items={{days}} as="day">
                <input name="days" type="checkbox" class="day-checkbox" on-change="updateSelectedDays" on-click="toggleChecked"  data-day$="{{day}}" checked="{{checkDays}}">
                {{day}}<br>
                </input>
            </template>
        </div>
    </template>

    <script>
        Polymer({
            is: 'cuac-schedule-days',

            ready: function() {
                this.week = {
                    MON: { checked: false },
                    TUE: { checked: false },
                    WED: { checked: false },
                    THU: { checked: false },
                    FRI: { checked: false },
                    SAT: { checked: false },
                    SUN: { checked: false },
                };
                this.days = Object.keys(this.week);
                this.updateSelectedDays();
            },

            properties: {
                selectedDays: {type: Array},

                checkDays: {type: Boolean, value: false, reflectToAttribute: true},

                clear: {type: Boolean, value: false, reflectToAttribute: true, 
                    observer: 'clearCheckedDays'}
            },

            checkAllDays: function() {
                this.checkDays = true;

                this.week = {
                    MON: { checked: true },
                    TUE: { checked: true },
                    WED: { checked: true },
                    THU: { checked: true },
                    FRI: { checked: true },
                    SAT: { checked: true },
                    SUN: { checked: true },
                };

                this.updateSelectedDays();
            },

            updateSelectedDays: function() {
                this.selectedDays = this.days.filter(function(day) {
                    return this.week[day].checked === true;
                }.bind(this));
                this.fire('daySelected', this.selectedDays);
            },

            toggleChecked: function(e) {
                var day = e.target.dataset.day;
                if(day == 'allDays') return;
                this.week[day].checked = (this.week[day].checked === false);
            },

            clearCheckedDays: function() {
                if  (this.clear) {
                    this.checkDays = undefined;                  
                }
            }
        });
    </script>
</dom-module>
