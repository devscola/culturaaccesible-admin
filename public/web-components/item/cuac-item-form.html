<link rel="import" href="/vendor/polymer/polymer.html">

<dom-module id="cuac-item-form">
    <template>
        <style>
            label{
              font-weight: normal;
            }
            .show {
                display: block;
            }

            .hide {
                display: none;
            }
        </style>
        <div class$="{{formVisibility}}">
            <div class="panel panel-primary">
                <div class="panel-heading">
                    Item form
                </div>
                <div class="panel-body form-group">
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="room">Room</label>
                            <input type="checkbox" name="room" on-change="hideUselessInputs"></input>
                        </div>
                        <div class="form-group">
                            <label for="beacon">Beacon Number</label>
                            <input class="form-control" name="beacon" value="{{beacon::input}}"></input>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="name"><b>Name*</b></label>
                            <input class="form-control" name="name" value="{{name::input}}" autofocus></input>
                        </div>
                        <div class="form-group">
                            <label for="author">Author</label>
                            <input class="form-control" name="author" value="{{author::input}}" type="{{inputVisibility}}"></input>
                        </div>
                        <div class="form-group">
                            <label for="date">Date</label>
                            <input class="form-control" maxlength="4" name="date" value="{{date::input}}" type="{{inputVisibility}}"></input>
                        </div>
                        <div class="form-group">
                            <label for="description">Description</label>
                            <textarea class="form-control" name="description" value="{{description::input}}"></textarea>
                        </div>
                    </div>
                </div>
            </div>
            <div class="text-center">
                <button type="button" class="btn btn-primary" on-click="submitClicked" name="submit">Save</button>
            </div>
        </div>

    </template>

    <script>
        Polymer({
            is: 'cuac-item-form',

            properties: {

                formVisibility: { type: String },

                inputVisibility: { type: String, value: 'text' },

                name: { type: String },

                author: { type: String },

                date: { type: String },

                beacon: { type: String },

                description: { type: String }
            },

            hideUselessInputs: function(event) {
                if (event.target.checked) {
                    this.inputVisibility = 'hidden';
                } else {
                    this.inputVisibility = 'text';
                }
            },

            submitClicked: function(event) {
                event.preventDefault();
                this.formVisibility = 'hide';
                this.fire('submitted', this.collectData());
            },

            loadExhibitionId: function() {
                return window.location.href.split('/item/')[1];
            },

            collectData: function() {
                data = {
                    name: this.name,
                    author: this.author,
                    date: this.date,
                    beacon: this.beacon,
                    description: this.description,
                    exhibition_id: this.loadExhibitionId()
                };
                return data;
            }

        });
    </script>
</dom-module>
